This is where the global state management happens.